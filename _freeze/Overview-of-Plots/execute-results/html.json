{
  "hash": "4e8895730f6a49619eb7afc39c47a007",
  "result": {
    "markdown": "---\ntitle: \"An Overview of Plotting Data in R\"\nauthor: 'Adam Spiegler, University of Colorado Denver'\noutput:\n  html_document:\n#    toc: yes\n#    toc_depth: 1\n#    theme: cerulean\n#jupyter:\n#  kernelspec:\n#    display_name: R\n#    language: R\n#    name: ir\n#output:\n#    ipynbdocument::ipynb_document\n---\n\n\n[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://githubtocolab.com/CU-Denver-MathStats-OER/Statistical-Theory/blob/main/Appendix/Overview-of-Plots.ipynb) <nbsp> \n\n\n# Introduction\n\n------------------------------------------------------------------------\n\nPlots can provide a useful visual summary of the data.\nSometimes, a nice plot or two is all that is need for statistical analysis.\nIn this document, we cover a basic overview of creating some plots in R.\n\nHere's a link to a more thorough coverage of plotting in R: <https://r-graph-gallery.com/index.html>.\n\n\n## Help Documentation\n\n------------------------------------------------------------------------\n\nThe plotting functions introduced in this document have robust help documentation with lots of options to customize your plots. If you want to view help documentation for any of the functions used in this document, run commands such`?hist`, `?plot`, `?table`, and so on.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# access help documentation for hist\n?hist  #Side panel should open with help doc\n```\n:::\n\n\n\n# What Are Packages in R?\n\n---\n\nR packages are a collection functions, sample data, and/or other code scripts. R installs a set of default packages during installation.\n\n**Run the code cell below to get a list of all default R packages that are already installed.**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# See a list of installed default packages\nallpack <- installed.packages()\nrownames(allpack)\n```\n:::\n\n\n\n## Loading Packages with the `library()` Command\n\n---\n\nEach time we start or restart a new session and want to access the library of functions and data in the package, we need to load the library of files in the package with the `library()` command.\n\nTo demonstrate how to create common statistical plots in R, we will use the `storms` data set which is located in the package `dplyr`.\n\n- The `dplyr` package is already installed in Google Colaboratory\n-  We still need to use a `library` command to load the package.\n- **Run the code cell below to load the `dplyr` package.**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load the library of functions and data in dplyr\nlibrary(dplyr)\n```\n:::\n\n\n## Reloading Packages When Restarting a Session\n\n---\n\nIf we take a break in our work, it is possible our R session will time out and close. <span style=\"color:tomato\">**Each time we restart an R session, we will need to rerun `library()` commands in order reload any packages we plan to use**</span>.\n\nThe same caution applies to any objects, vectors, or data frames we create or edit in an R session. If a session times out, and we want to use an object `x` that we previously created, we will need to run the code cell(s) where object `x` is created again before we can refer back to `x` in the current session.\n\n**BE SURE YOU RUN THE COMMAND `library(dplyr)` BEFORE ATTEMPTING TO RUN ANY OF THE CODE CELLS BELOW!**\n\n# Summarizing `storms` Data\n\n---\n\nThe package `dplyr` contains a data set called `storms`. Let’s find some useful information about this data.\n\n- The first code cell below will open the help manual for `storms` in a side bar.\n  - Feel free to close the help side bar.\n- The second code cell below will provide a numeric summary of all variables in the `storms` data.\n- Recall we need to first run the command `library(dplyr)` in the code cell above to be able to access `storms`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# be sure to run the code cell above first\n# so you have loaded the dplyr package\n?storms  \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# See a summary of all variables\nsummary(storms)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     name                year          month             day       \n Length:19066       Min.   :1975   Min.   : 1.000   Min.   : 1.00  \n Class :character   1st Qu.:1993   1st Qu.: 8.000   1st Qu.: 8.00  \n Mode  :character   Median :2004   Median : 9.000   Median :16.00  \n                    Mean   :2002   Mean   : 8.699   Mean   :15.78  \n                    3rd Qu.:2012   3rd Qu.: 9.000   3rd Qu.:24.00  \n                    Max.   :2021   Max.   :12.000   Max.   :31.00  \n                                                                   \n      hour             lat             long                         status    \n Min.   : 0.000   Min.   : 7.00   Min.   :-109.30   tropical storm     :6684  \n 1st Qu.: 5.000   1st Qu.:18.40   1st Qu.: -78.70   hurricane          :4684  \n Median :12.000   Median :26.60   Median : -62.25   tropical depression:3525  \n Mean   : 9.094   Mean   :26.99   Mean   : -61.52   extratropical      :2068  \n 3rd Qu.:18.000   3rd Qu.:33.70   3rd Qu.: -45.60   other low          :1405  \n Max.   :23.000   Max.   :70.70   Max.   :  13.50   subtropical storm  : 292  \n                                                    (Other)            : 408  \n    category          wind           pressure      tropicalstorm_force_diameter\n Min.   :1.000   Min.   : 10.00   Min.   : 882.0   Min.   :   0.0              \n 1st Qu.:1.000   1st Qu.: 30.00   1st Qu.: 987.0   1st Qu.:   0.0              \n Median :1.000   Median : 45.00   Median :1000.0   Median : 110.0              \n Mean   :1.898   Mean   : 50.02   Mean   : 993.6   Mean   : 146.3              \n 3rd Qu.:3.000   3rd Qu.: 65.00   3rd Qu.:1007.0   3rd Qu.: 220.0              \n Max.   :5.000   Max.   :165.00   Max.   :1024.0   Max.   :1440.0              \n NA's   :14382                                     NA's   :9512                \n hurricane_force_diameter\n Min.   :  0.00          \n 1st Qu.:  0.00          \n Median :  0.00          \n Mean   : 14.81          \n 3rd Qu.:  0.00          \n Max.   :300.00          \n NA's   :9512            \n```\n:::\n:::\n\n\n\n# One Quantitative Variable\n\n------------------------------------------------------------------------\n\nOften a graph or plot is a more preferred format to summarize a variable than a summary statistics. The documentation below explains we could graphically summarize the quantitative variable `pressure`.\n\n\n## Histograms\n\n------------------------------------------------------------------------\n\nThe `hist` function can be used create a\n<span style=\"color:dodgerblue\">**histogram**</span> of a numerical vector.\n\n-  See histogram documentation: <https://r-graph-gallery.com/histogram.html>\n- Like making colorful plots? [Here’s a guide to colors in R](https://bookdown.org/hneth/ds4psy/D-3-apx-colors-basics.html).\n- We use a `$` symbol to indicate the name of the variable in `storms` we will access in the plot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(storms$pressure,  # plot pressure variable in storms data\n     xlab = \"storm pressure (in millibars)\",  # x-axis label\n     main = \"Distribution of Storm Pressure\",  # main title\n     breaks = 10,  # number of breaks or bins\n     col = \"aquamarine4\")  # color of bars\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Density plots\n\n------------------------------------------------------------------------\n\nA histogram is more sensitive to its options. For example, a histogram with 3 breaks may tell a different story than plotting the same data with 20 breaks.\n\nThus, we may prefer to use a <span style=\"color:dodgerblue\">**density plot**</span>.\n\n1. First compute density of `pressure`. \n  - For more information, see [density help documentation](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/density).\n\n2. The `plot()` function will then create a density plot.\n\n- For more advanced density plots see <https://r-graph-gallery.com/density-plot.html>.\n- If a variable is categorical, `plot()` will create a different plot, namely a bar chart.\n- `plot()` can also be used to generate a plot to compare two different variables.\n- The output of `plot()` depends on the type and number of variables that we input in the function. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# approximate densities and then plot\nplot(density(storms$pressure),\n     xlab = \"storm pressure (in millibars)\",  # horizontal axis label\n     main = \"Distribution of Storm Pressure\")  # main title\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Boxplots\n\n------------------------------------------------------------------------\n\n<span style=\"color:dodgerblue\">**Boxplots**</span> are another useful plot\nfor presenting the distribution of a quantitative variable using quartiles and the five number summary.\n\n-  See boxplot documentation at <https://r-graph-gallery.com/boxplot.html>.\n- Run the command `?boxplot` to see more options.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create boxplot of quantitative variable\nboxplot(storms$pressure,\n        ylab = \"storm pressure (in millibars)\",  # horizontal axis label\n        col = \"gold\",  # color of box\n        main = \"Distribution of Storm Pressure\")  # main title\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Changing the Layout of Boxplots\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# horizontally aligned boxplot\nboxplot(storms$pressure,\n        horizontal = TRUE,  # display horizontally\n        xlab = \"storm pressure (in millibars)\",  # horizontal axis label\n        main = \"Distribution of Storm Pressure\",  # main title\n        col = \"azure3\")  # color\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n# One Qualitative Variable\n\n------------------------------------------------------------------------\n\nQualitative (also called categorical) variables required other types of plots. For example, we cannot create a density or boxplot for a qualitative variable. Qualitative variables may be stored as characters (such as the `status` variable) or values (such as the `category` variable). This brings up a good question:\n\n> How can we tell whether a variable is stored as a numerical variable, a categorical variable, or perhaps as a string of characters?\n\n\n## Checking the Data Type\n\n---\n\n**The `typeof()` command can help identify what is the type of a variable.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntypeof(storms$status)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"integer\"\n```\n:::\n\n```{.r .cell-code}\ntypeof(storms$category)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"double\"\n```\n:::\n:::\n\n\n### Data Types\n\n---\n\nFrom the output above, we see:\n\n-   The variable `status` is initially read as an `integer`.\n  - The individual values are **strings of characters** such as \"tropical storm\" or \"hurricane\".\n  - The summary statistics of `status` are **counts** that are stored as integers.\n-   The variable `category` is initially read as `double` or decimal values.\n  - The individual values are ordinal integers \"1\", \"2\", \"3\", \"4\", and \"5\" for category of hurricane. \n  - There are 14,2328 `NA` (or missing) values corresponding to the observations that are not hurricanes.\n  - The summary statistics of `category` (such as the mean) are stored decimals.\n  - However, we would like to treat `category` as a qualitative variable and plot how many storms fall into each category.\n\n\n## Caution with Data Types and Using `plot()`\n\n---\n\nIf we try to use the general `plot()` function, R will give its best guess at which plot makes the most sense to display the data. If the data is stored as the wrong data type, `plot()` will not work as we might expect.\n\n- Run the two code cells below, and notice the following:\n  - The output of the `plot(storms$status)` looks like a reasonable bar chart.\n  - The output of `plot(storms$category)` does not nicely summarize the counts of how many storms are in each category.\n  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(storms$status)  # plot of status\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(storms$category)  # plot of category\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n## Creating Bar Charts From Tables\n\n---\n\nThe `table()` function will count the number of times a value (or string\nof characters) occurs in a vector or variable.\n\n-   [Official Documentation Page for `table()`](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/table)\n-   [Another nice resource with examples](https://www.statology.org/table-function-in-r/)\n\nOne way to improve the initial plot of categories above is as follows:\n\n1. First use the `table()` command to count how many storms are in each category.\n2. Then create a bar chart using the `barplot()` function.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat.table <- table(storms$category)  # create table of counts\ncat.table  # print table to screen\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n   1    2    3    4    5 \n2478  973  579  539  115 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create bar chart from table counts\nbarplot(cat.table,  # input table from previous code cell\n        main = \"Distribution of Hurricane Categories\",  # main title\n        xlab = \"Hurricane Category\",  # horizontal axis label\n        ylab = \"Frequency\",  # vertical axis label\n        col = \"steelblue\")  # fill color of bars\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n## Relative Frequency Tables and Bar Charts\n\n---\n\nIf instead of plotting the number of hurricanes in each category we wish to plot the **proportion** of all hurricanes in each category, we can use the `prop.table()` function to convert the table counts to proportions relative to the grand total.\n\n**Run the two code cells below to create a relative frequency bar chart.**\n\n1. We input our previous table of counts, `cat.table`, into the function `prop.table()` to convert counts to proportions.\n2. Then we create a bar chart of the resulting proportions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat.prop <- prop.table(cat.table)  # create table of proportions\nbarplot(cat.prop,  # input table of proportions\n        main = \"Relative Frequency of Hurricane Categories\",  # main title\n        xlab = \"Hurricane Category\",  # horizontal axis label\n        ylab = \"Proportion\",  # vertical axis label\n        col = \"steelblue\")  # fill color of bars\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\n::: {.callout-caution}\n### Caution with `prop.table()`\n\n---\n\n- <span style=\"color:tomato\">The input into `prop.table()` must be a table rather than a vector or data frame column.</span>\n-  The code cell below does return a relative frequency table as we would expect since we did not <span style=\"color:dodgerblue\">first create a table of counts from `storms$category`</span>.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp <- prop.table(storms$category)  # do not input a vector\nhead(temp)  #  print first several entries of result\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] NA NA NA NA NA NA\n```\n:::\n:::\n\n\n\n## Pie Charts with `pie()`\n\n---\n\n<span style=\"color:dodgerblue\">**Pie charts**</span> can also be used to illustrate the distribution of one qualitative variable.\n\n-   See <https://r-graph-gallery.com/pie-plot.html>.\n-   For help and a list of options, you can run `?pie`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n?pie\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create pie chart of one qualitative variable\npie(cat.table,  # input table\n    main = \"Distribution of Hurricane Categories\")  # main title\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## Converting to a `factor()` and Then `plot()`\n\n---\n\nOne common issue with a qualitative variable is that it is often stored as the wrong datatype.\n\n-  <span style=\"color:dodgerblue\">**Qualitative data should typically be stored as a `factor`.**</span>\n\nAnother way we can create a bar chart of the counts in each category is to:\n\n1. First convert the qualitative variable to a `factor`. \n2. Then use `plot()` to create an appropriate plot.\n\n**Run the code cell below to first see the summary output of the `category` variable after converting it to a `factor`.**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# creates a copy of storms data set\n# so we don't overwrite original storms\nstorms2 <- storms  \n\nstorms2$category <- factor(storms$category)  # convert category to factor\nsummary(storms2$category)  # get new summary of categories\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    1     2     3     4     5  NA's \n 2478   973   579   539   115 14382 \n```\n:::\n:::\n\n\nNotice the summary is a table of counts in each hurricane category.\n\n-  Once the variable `status` is converted to a `factor`, the `plot()` function will know to use a bar chart to give a summary display.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create bar chart from counts of a factor\nplot(storms2$category,  # input a factor\n     main = \"Distribution of Hurricane Category\",  # main title\n     xlab = \"Hurrican Category\",  # horizontal axis label\n     ylab = \"Frequency\",  # vertical axis label\n     col = \"steelblue\")  # color of fill of ba\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n- <span style=\"color:tomato\">**Recall without first changing `category` to a `factor`, `plot()` will create a different graph.**</span>\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# default plot of category when not first converted to factor\nplot(storms$category)\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n# Plotting One Quantitative and One Qualitative Variable<\n\n---\n\nImagine we would like to compare the wind speeds of storms by status. In this case, we would like to compare a quantitative variable (`wind`) for different classes of a qualitative variable (`status`).\n\n## Side by Side Boxplots\n\n---\n\nThere are many classes of storms status in `storms`.\n\nIn the storms data:\n\n- `wind` is a quantitative variable.\n- `status` is a qualitative variable.\n- We can use the default `plot()` function to create a side by side boxplots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a vector of fill colors\n# one color for each status type.\nmy.colors <- c(\"green\", \"purple\", \"grey\", \"red\", \n               \"blue\", \"gold\", \"cyan\", \"pink\", \"orange\")\n\nplot(wind ~ status,  # quantitative first ~ categorical second\n     data = storms,  # name of data frame\n     col = my.colors,  # fill colors\n     main = \"Wind Speeds of Storms by Status\")  # main title\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n### Adding a Legend to Plots\n\n---\n\n- There are a lot of different status of storms.\n- It is not easy (or possible) to tell which boxplot corresponds to which storm status.\n- Adding a <span style=\"color:dodgerblue\">**legend**</span> to the plot will help!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a table of status counts\n# we will pull of the row names of the table\n# as the labels in the legend\nstatus.table <- table(storms$status)\n\nplot(wind ~ status,  # quantitative first ~ categorical second\n     data = storms,  # name of data frame\n     col = my.colors,  # fill colors colors\n     ylab = \"Wind speed in knots\",  # vertical axis label\n     main = \"Wind Speeds of Storms by Status\")  # main title\n\n# we can add a legend to identify which plot is which storm status\nlegend(x = \"topright\",  # place legend in top right corner\n       legend=rownames(status.table),  # each row of table is label in legend\n       fill = my.colors)  # fill colors\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n## Subsetting Data by Category\n\n---\n\nThere are many classes of storms status in `storms`. Often, we want to only focus on a smaller subset of classes. We can restrict our attention to compare the wind speeds of three of the classes: \"tropical storm\", \"tropical depression\", and \"hurricane\".\n\n\n-   We can <span style=\"color:dodgerblue\">**subset**</span> `storms` data frame into three separate data frames, one for each status of storm, using the `subset()` function.\n  - Curious to learn more about `subset`? Run `?subset` in a code cell to access help documentation.\n-   Then we can create three separate boxplots of the wind speeds for each status.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# split data by storm status\nhur <- subset(storms,  # data frame name\n              status == \"hurricane\",  # logical test to select observations\n              select = wind)  # which quantitative variable(s) to select\n\ntrop.storm <- subset(storms, \n                     status == \"tropical storm\",  # tropical storms\n                     select = wind)\ntrop.dep <- subset(storms, \n                   status == \"tropical depression\",   # tropical depressions\n                   select = wind)\n\n# create side by side boxplot\n# for each of the three subsets\nboxplot(hur$wind, trop.storm$wind, trop.dep$wind, \n        main = \"Windspeed of Storms\", \n        names = c(\"Hurricanes\", \"Tropical Storms\", \"Tropical Depressions\"), \n        col = c(\"red\", \"blue\", \"green\"), \n        xlab = \"Wind speed in knots\", \n        horizontal = TRUE)\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n# Relationship Between Two Qualitative Variables\n\n------------------------------------------------------------------------\n\n\nImagine we would like to compare the number of different category hurricanes that occurred in each month. In this case, we would like to compare two qualitative variables, namely `category` and `month`.\n\n\n## Creating Contingency or Two-Way Table\n\n---\n\nThe command `table(x)` will count the number of times a value (or string of characters) occurs in a vector `x`.\n\n-   [Official Documentation Page for `table()`](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/table)\n-   [Nice resource with examples](https://www.statology.org/table-function-in-r/)\n\nThe command `table(x, y)` will similarly create a contingency (or two-way) table to jointly compare counts of `x` and `y`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a contingency table for status and month\ncon.table <- table(storms$category, storms$month) \ncon.table  # print output to screen\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   \n       1    4    5    6    7    8    9   10   11   12\n  1    5    0    0   18  140  581 1099  462  140   33\n  2    0    0    0    0   25  198  571  150   29    0\n  3    0    0    0    0   18  113  346   86   16    0\n  4    0    0    0    0   18  114  295   88   24    0\n  5    0    0    0    0    1   32   69   13    0    0\n```\n:::\n:::\n\n\n\n## Creating Grouped Frequency Bar Charts\n\n---\n\nAfter creating a two-way table, we can present the results visually in a <span style=\"color:dodgerblue\">**grouped bar chart**</span>.\n\n-  See documentation at <https://r-graph-gallery.com/211-basic-grouped-or-stacked-barplot.html>.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a vector of colors\nmy.colors2 <- c(\"green\", \"purple\", \"grey\", \"red\", \"blue\") \n\n# create side by side bar chart\nbarplot(con.table,  # use counts from contingency table\n        beside = TRUE,  # groups side-by-side\n        main = \"Category Hurricanes By Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        col = my.colors2,  # fill color of bars\n        ylab = \"Frequency\")  # vertical axis label\n\n# add a legend to plot\nlegend(x=\"topleft\",  # place legend in top left\n       legend=rownames(con.table),  # get labels from row name in contingency table\n       fill = my.colors2)  # use same fill colors\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n## Grouped Frequency Bar Charts\n\n---\n\n-   Note `beside = FALSE` is the default.\n-   If we do not specify a `beside` option, a **stacked bar chart** is created instead.\n-   In the second code cell, we also add a legend to the plot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n########################################################\n# Note this has already been run in a previous section\n# You do not need to run again if already created\n#######################################################\n\n# create a contingency table for status and month\ncon.table <- table(storms$category, storms$month) \ncon.table  # print output to screen\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a vector of colors\nmy.colors2 <- c(\"green\", \"purple\", \"grey\", \"red\", \"blue\") \n\n# create stacked bar chart\nbarplot(con.table,  # use counts from contingency table\n        main = \"Category Hurricanes By Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        col = my.colors2,  # color of bars\n        ylab = \"Frequency\")  # vertical axis label\n\n# add legend to plot\nlegend(x=\"topleft\",  # place legend in top left\n       legend=rownames(con.table),  # get labels\n       fill = my.colors2)  # use same colors\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n## Stacked Bar Charts Relative to Grand Total\n\n---\n\n1. First we create a contingency table using `table(x, y)`.\n2. Then we use `prop.table([table_name])` to convert to frequencies to proportions out of the grand total.\n3. Finally we can create a group bar chart of relative frequencies.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create two-table of counts\ncon.table <- table(storms$category, storms$month)\n\n# convert counts to proportions\ncon.prop <- prop.table(con.table) \n\n# create a vector of colors\nmy.colors2 <- c(\"green\", \"purple\", \"grey\", \"red\", \"blue\") \n\n# create stacked bar chart\nbarplot(con.table,  # use counts from contingency table\n        main = \"Category Hurricanes By Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        col = my.colors2,  # color of bars\n        ylab = \"Relative Frequency (of grand total)\")  # vertical axis label\n\nlegend(x=\"topleft\",  # place legend in top left\n       legend=rownames(con.table),  # get labels\n       fill = my.colors)  # use same fill colors\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n## Stacked Bar Chart Relative to Column Totals\n\n---\n\nOften, we would like the proportions in the table to be computed out of the total in each column (instead of the grand total).\n\n-   We add the option `2` inside `prop.table()`.\n-   In this example, each column is a different month.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create two-table of counts\ncon.table <- table(storms$category, storms$month)\n\n# convert counts to proportions\n# note the option 2 added to command below\ncon.prop.column <- prop.table(con.table, 2)  \n\n# create a vector of colors\nmy.colors2 <- c(\"green\", \"purple\", \"grey\", \"red\", \"blue\") \n\n# create stacked bar chart\nbarplot(con.prop.column,  # use counts from contingency table\n        main = \"Category Hurricanes By Month\",  # main title\n        xlab = \"Month\",  # horizontal axis label\n        col = my.colors2,  # color of bars\n        ylab = \"Relative Frequency (to month totals\")  # vertical axis label\n\nlegend(x=\"topleft\",  # place legend in top left\n       legend=rownames(con.table),  # get labels\n       fill = my.colors)  # use same fill colors\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\n# Relationship Between Two Quantitative Variables\n\n------------------------------------------------------------------------\n\n\nImagine we would like to compare the wind speeds (`wind`) to the pressure (`pressure`). In this case, we would like to compare two quantitative variables.\n\nA <span style=\"color:dodgerblue\">**scatter plot**</span> can be\nused to identify the relationship between two quantitative variables.\n\n-  **If both variables are quantitative, the `plot()` function by default will create a scatter plot to compare the two variables.**\n\n-  For other types of scatter plots, see documentation: <https://r-graph-gallery.com/scatterplot.html>.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a scatter plot\n# first variable wind is response (y-axis)\n# second variable pressure is predictor (x-axis)\n\nplot(wind ~ pressure,  # response ~ predictor(s)\n     data = storms,  # data frame name\n     main = \"Relation of Pressure and Wind Speed of Storms\",  # main title\n     xlab = \"Pressure (in millibars)\",  # horizontal axis label\n     ylab = \"Wind Speed (in knots)\")  # vertical axis label\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n# Arranging Multiple Plots in an Array\n\n------------------------------------------------------------------------\n\n-   The command `par(mfrow =c(n,m)` creates an array of $n$ rows and $m$ columns.\n\n-   Plots will fill the array based on the order they are plotted.\n\n-   See <https://bookdown.org/ndphillips/YaRrr/arranging-plots-with-parmfrow-and-layout.html> for more info.\n\n- See previous sections for further information about each of the plots created below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))  # create a 2 x 2 array of plots\n\n# the next 5 plots created will be arranged in the array\nboxplot(storms$wind)  # create boxplot of wind speed\n\n# code below creates a histogram of wind speed\n# we can add many options to customize\nhist(storms$wind, xlab = \"wind speed (in knots)\",   # x-axis label\n     ylab = \"Frequency\",  # y-axis label\n     main = \"Distribution of Storm Wind Speed 1975-2020\",  # main label\n     col = \"steelblue\")  # change color of bars\n\nplot(storms$status, col = \"gold\")  # plots status, which is categorical\n\nplot(wind ~ pressure, data = storms)  # plots two numerical variables\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a table of status counts\n# we will pull of the row names of the table\n# as the labels in the legend\nstatus.table <- table(storms$status)\n\nplot(wind ~ status,  # quantitative first ~ categorical second\n     data = storms,  # name of data frame\n     col = my.colors,  # fill colors colors\n     ylab = \"Wind speed in knots\",  # vertical axis label\n     main = \"Wind Speeds of Storms by Status\")  # main title\n\n# we can add a legend to identify which plot is which storm status\nlegend(x = \"topright\",  # place legend in top right corner\n       legend=rownames(status.table),  # each row of table is label in legend\n       fill = my.colors)  # fill colors\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n\n# More Advanced Plots with `ggplot2`\n\n---\n\nThe previous plots were created using R’s <span style=\"color:dodgerblue\">**base** graphics system</span>.\n\n-   **base** graphics are fast and simple to produce while looking\n    professional.\n\nA <span style=\"color:dodgerblue\">fancier alternative is to construct plots using the `ggplot2` package.</span>\n\n-   The `gg` stands for **Grammar of Graphics**.\n\nIn its simplest form, to construct a (useful) plot in `ggplot2`, you\nneed to provide:\n\n-   <span style=\"color:dodgerblue\">A `ggplot` object.</span>\n    -   This is usually the object that holds your data frame.\n    -   The data frame is passed to `ggplot` via the first `data` argument.\n\n-   <span style=\"color:dodgerblue\">A geometry object.</span>\n    -   Roughly speaking, this is the *kind* of plot you want.\n    -   e.g., `geom_histogram` for a histogram, `geom_point` for a scatter plot, `geom_density` for a density plot.\n-   <span style=\"color:dodgerblue\">An aesthetic mapping.</span>\n    -   Aesthetic mappings describe how variables in the data are mapped to visual properties of a geometry.\n    -   This is where you specify which variable with be the `x` variable, the `y` variable, which variable will control color in the plots, etc.\n-   See <https://ggplot2.tidyverse.org> for documentation.\n-   Download a [ggplot2 cheatsheet](https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf).\n\n## Loading `ggplot2`\n\n------------------------------------------------------------------------\n\n- The `ggplot2` package is already installed as a default package in Google Colaboratory.\n\n- However, recall each time we start or restart a new session and want to access the library of functions and data in the package, we need to load the library of files in the package with the `library` command.\n- **Run the first code cell below to load the `ggplot2` package.**\n- If restarting a new session, you also need to reload the `dplyr` package to access `storms` data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)  # make sure you have installed ggplot2 package\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# may need to reload\nlibrary(dplyr)\n```\n:::\n\n\n\n## Plotting One Numerical Variable with `ggplot2`\n\n------------------------------------------------------------------------\n\nTo create various types of plots for one quantitative variable, such as `wind`:\n\n- The **ggplot object** is the data frame `storms`.\n- The **aesthetic** is the variable `wind` that we will plot on the x-axis.\n- Geometric objects histogram, density, and boxplot are specified in each of the three code cells below.\n- There a numerous options we can include as well.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a histogram\nggplot(storms, aes(x = wind)) + \n  geom_histogram(fill = \"steelblue\", color=\"black\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a density plot\nggplot(storms, aes(x = wind)) + \n  geom_density(color=\"red\") + \n  theme_bw() # adding theme_bw()  makes white background\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a boxplot\nggplot(storms, aes(x = wind)) + \n  geom_boxplot(color=\"black\", fill=\"blueviolet\")\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\n## Scatter Plots with `ggplot2`\n\n------------------------------------------------------------------------\n\n\nTo create a scatter plot to compare two quantitative variables such as wind speed and pressure of storms:\n\n- The **ggplot object** is the data frame `storms`.\n- The **aesthetic** are the variables\n  - `pressure` is the predictor plotted on the x-axis.\n  - `wind` is the response plotted on the y-axis.t\n- Geometric object is scatter.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a scatter plot\nggplot(storms) + \n  geom_point(aes(x = pressure, y = wind))\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n\n## Scaling `ggplot2` plots\n\n------------------------------------------------------------------------\n\n\nIn general, <span style=\"color:dodgerblue\">**scaling**</span> is the process by which `ggplot2` maps variables to unique values. When this is done for discrete numeric or qualitative variables, `ggplot2` will often scale the variable to distinct colors,\nsymbols, or sizes, depending on the aesthetic mapped.\n\nIn the example below, we map the `status` variable to the `color` aesthetic, which is then scaled to different colors for the different `status` levels.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# scatter plot with scaling\nggplot(storms) + \n  geom_point(aes(x = pressure, y = wind, color = status))\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\n\n### Scaling by Shape\n\n---\n\nAlternatively, we can map the `status` variable to the `shape`\naesthetic, which creates a plot with different shapes for each\nobservation based on the `status` level.\n\n- By default, 6 shapes can be used.\n- There are 9 different status of storms.\n- The last option manually sets the shapes for each status to avoid an error.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# scaling by shape\nggplot(storms) + \n  geom_point(aes(x = pressure, y = wind, shape = status)) + \n  scale_shape_manual(values=0:8)  # manually setting shapes\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n\n### Applying Multiple Scales \n\n---\n\nWe can even combine these two aesthetic mappings in a single plot to get\ndifferent colors and symbols for each level of `month` and `status`, respectively.\n\n- By default, 6 shapes can be used.\n- There are 9 different status of storms.\n- The last option manually sets the shapes for each status to avoid an error.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# scaling by month and status\nggplot(storms) + \n  geom_point(aes(x = pressure, y = wind, color = month, shape = status)) + \n  scale_shape_manual(values=0:8)  # manually setting shapes for status\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\n\n## Facetting in `ggplot2`\n\n------------------------------------------------------------------------\n\n<span style=\"color:dodgerblue\">**Faceting**</span> creates separate panels (facets) of a data frame based on one or more faceting variables.\n\nTo create various scatter plots (one for each category) to compare two quantitative variables such as wind speed and pressure of storms, we can add a `facet_grid`.\n\n- Note the NA plot corresponds to the storms that are not hurricanes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# faceting by category\nggplot(storms) + \n  geom_point(aes(x = pressure, y = wind)) + \n  facet_grid(~ category)\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n## Bar Charts with `ggplot2`\n\n---\n\nImagine we would like to compare the number of different types of storms (`status`) that occurred in each month.\n\n\n### Stacked Bar Charts of Counts with `ggplot2`\n\n---\n\nTo create a stacked bar chart of counts for one or more qualitative variable:\n\n- The **ggplot object** is the data frame `storms`.\n- Geometric **object** is `geom_bar`.\n- The **aesthetic** is specified as:\n  - Fill color, (`fill`) is `status`.\n  - The height of each bar is summarizing the statistic (`stat`) is `\"count\"`.\n  - The `position=\"stack\"` creates a stacked bar chart of counts.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# stacks bars on top of each other \nggplot(storms, aes(x=month)) + \n    geom_bar(aes(fill=status), stat = \"count\", position=\"stack\") + \n    ggtitle(\"Occurrence of Storms by Month\")\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\n### Stacked Relative Frequency Bar Charts with `ggplot2`\n\n---\n\nTo create a stacked bar chart of relative frequencies for two qualitative variables:\n\n- The **ggplot object** is the data frame `storms`.\n- Geometric **object** is `geom_bar`.\n- The **aesthetic** is specified as:\n  - Fill color, (`fill`) is `status`.\n  - The height of each bar is summarizing the statistic (`stat`) is `\"count\"`.\n  - The `position=\"fill\"` creates a stacked bar chart of relative frequencies.\n  \n  \n\n::: {.cell}\n\n```{.r .cell-code}\n# stacks bars and standardizing each stack\nggplot(storms, aes(x=month)) + \n    geom_bar(aes(fill=status), stat = \"count\", position=\"fill\") +  \n    ggtitle(\"Occurrence of Storms by Month\")\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\n### Grouped Bar Charts of Counts with `ggplot2`\n\n---\n\nTo create various types of bar plots for one or more qualitative variables:\n\n- The **ggplot object** is the data frame `storms`.\n- Geometric **object** is `geom_bar`.\n- The **aesthetic** is specified as:\n  - Fill color, (`fill`) is `status`.\n  - The height of each bar is summarizing the statistic (`stat`) is `\"count\"`.\n  - The `position=\"dodge\"` creates a stacked bar chart.\n  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# creates grouped bar chart\nggplot(storms, aes(x=month)) + \n    geom_bar(aes(fill=status), stat = \"count\", position=\"dodge\") +  \n    ggtitle(\"Occurrence of Storms by Month\")\n```\n\n::: {.cell-output-display}\n![](Overview-of-Plots_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n\n# Spatial Plots with `mapview`\n\n------------------------------------------------------------------------\n\n## Load Library\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mapview)  # load spatial mapping package\n```\n:::\n\n\n## Mapping All Storms by Status\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmapview(storms, xcol = \"long\", ycol = \"lat\", \n        zcol = \"status\", \n        crs = 4269, grid = FALSE)\n```\n:::\n\n\n## Mapping Category 5 Hurricanes\n\n------------------------------------------------------------------------\n\nFirst we filter out observations with `category` equal to 5.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat5 <- subset(storms , category == \"5\")  # keep only category 5\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmapview(cat5, xcol = \"long\", ycol = \"lat\", cex = \"wind\", crs = 4269, grid = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmapview(cat5, xcol = \"long\", ycol = \"lat\", zcol = \"name\", cex = \"wind\", crs = 4269, grid = FALSE)\n```\n:::\n\n\n## Creative Commons License Information {#sec-cc}\n\n---\n\n![Creative Commons License](https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png) <nbsp>\n\n*Statistical Methods: Exploring the Uncertain* by [Adam Spiegler](https://github.com/CU-Denver-MathStats-OER/Statistical-Theory) is licensed under a [Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-nc-sa/4.0/).\n\n",
    "supporting": [
      "Overview-of-Plots_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}