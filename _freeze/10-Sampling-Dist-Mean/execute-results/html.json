{
  "hash": "c158fbc1d9462f85f834747a49e9c8b0",
  "result": {
    "markdown": "---\n#title: '3.1: Sampling Distribution of Means'\n#author: 'Adam Spiegler, University of Colorado Denver'\noutput:\n  html_document:\n#    toc: yes\n#    toc_depth: 1\n#    theme: cerulean\n#jupyter:\n#  kernelspec:\n#    display_name: R\n#    language: R\n#    name: ir\n#output:\n#    ipynbdocument::ipynb_document\n---\n\n\n[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://githubtocolab.com/CU-Denver-MathStats-OER/Statistical-Theory/blob/main/Chap3/10-Sampling-Dist-Mean.ipynb){target=\"_blank\"} <nbsp>\n\n# 3.1: Sampling Distribution of Means\n\n----\n\nA <span style=\"color:dodgerblue\">**sampling distribution**</span> is the distribution of sample statistics (such as a mean, proportion, median, maximum, etc.) computed for **different samples of the same size from the same population**. A sampling distribution shows us how much the sample statistic varies from sample to sample. The exercises in this section compare the sampling distributions for means from different populations with differently shaped distributions.\n\n\n\n\n## Question 1\n\n---\n\nConsider three distributions:\n\n-   Let $X$ denote the distribution of Body Mass Index (BMI) of all adult men.\n-   Let $Y$ denote all times (in minutes) that people wait before their train arrives at a certain train station.\n-   Let $Z$ denote the depth (in km) of all earthquakes that have occurred near Fiji since 1964.\n\n\nFor each population $X$, $Y$, and $Z$, do you believe the distribution will be approximately symmetric, skewed left, skewed right, or are you unsure what shape to expect? Explain how you determined your answers.\n\n\n### Solution to Question 1\n\n---\n\n- Shape of population $X$:\n\n\n\\\n\n\n- Shape of population $Y$:\n\n\n\\\n\n- Shape of population $Z$:\n\n\n\\\n\\\n\n\n# The Population Data for BMI\n\n----\n\n\nLet $X$ denote the distribution of BMI of all adult men. We can approximate this distribution by $X \\sim N(26, 4)$. First, we generate a vector of 100 BMI values that we store in `bmi`. The 100 BMI values go from a minimum value that is 4 standard deviations below the mean, $26-4 \\cdot 4 = 10$, up to a maximum value that is 4 standard deviations above the mean, $26+4 \\cdot 4 = 42$. Run the code cell below to create the vector of BMI values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbmi <- seq(26 - 4*4, 26 + 4*4, length=100)\n```\n:::\n\n\n:::{.callout-note}\nRunning the code cell will not result in any output printed to the screen. The output is stored in `bmi`.\n:::\n\n\n## Question 2\n\n----\n\nThe code cell below generates a plot to display the distribution of BMI values. $X$. Before running the code cell:\n\n- Interpret each line of the code. \n- Add comments to explain what each command will do. \n\nAfter adding your comments, run the code cell and check the output looks reasonable.\n\n\n### Solution to Question 2\n\n----\n\nReplace each `??` in the code cell below with an appropriate comment to explain what the code is doing.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# add your comment to explain the command below\npdf.bmi <- dnorm(bmi, 26, 4)  # ??\n\nplot(bmi,  # bmi values are plotted on x-axis\n     pdf.bmi,  # corresponding heights plotted on y-axis\n     type=\"l\",  # plot type \"l\" will connect points with a line \n     lty=1,  # lty=1 plots solid line\n#################################################    \n#  add comments to explain each of the remaining options\n#################################################\n     xlab=\"Body Mass Index (BMI)\",  # ??\n     ylab=\"Density\",  # ??\n     main=\"Distribution of Population\")  # ??\n```\n\n::: {.cell-output-display}\n![](10-Sampling-Dist-Mean_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n:::{.callout-warning}\nAfter running the code, be sure the output looks correct.\n:::\n\n\n## Picking One Random Sample\n\n---\n\n\nWe can use the command `rnorm(n, mean, sd)` to pick a random sample of size $n$ from a normal distribution $N(\\mu, \\sigma)$.\n\n## Question 3\n\n----\n\nReplace the question mark in the code cell below to randomly select 4 individual BMIâ€™s from the population $X \\sim N(26,4)$.\n\n\n### Solution to Question 3\n\n----\n\nEdit and run the code cell below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# enter a command to randomly picks 4 values from N(26,4)\nmy.sample <- ??\n  \nmy.sample  # print your sample to the screen\n```\n:::\n\n\n\n\n## Question 4\n\n----\n\nCalculate the mean and standard deviation of your sample stored in `my.sample` using the code below. After computing the statistics to summarize your sample, consider the following questions:\n\n-   How do your sample statistics compare to the population parameters $\\mu = 26$ and $\\sigma =4$?\n-   How do expect your sample statistics will compare to the statistics that others in class obtain from their own random samples?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# enter a command to compute the mean of my.sample\n\n# enter a command to compute the st. dev. of my.sample\n```\n:::\n\n\n\n### Solution to Question 4 \n\n----\n  \nAfter checking the output of the code cell above, be sure to address the two questions in the bullets above.\n  \n\\\n\\\n\\\n\n# Sampling Distribution for BMI Means with $n=4$\n\n----\n\nA sample of $n=4$ adult men are randomly selected. The mean BMI of the sample is calculated using the formula for a sample mean: \n\n$$\\bar{x} = \\frac{x_1 + x_2 + x_3+x_4}{4}.$$\n\nThen we repeat this process many, many times:\n\n1. Pick a random sample of $n=4$ adult men from the population.\n2. Calculate the sample mean of the new sample.\n3. Repeat over and over again (for example 1,000 times).\n\nThe <span style=\"color:dodgerblue\">**sampling distribution of the means**</span> is the distribution of all sample means obtained by repeatedly picking random samples each of size $n$.\n\n- It is important to note that **each sample must have the same size**, $n$.\n- The sampling distribution for the mean is the distribution of all possible random samples.\n  - It is extremely difficult and time intensive to write and run code that generates every possible random sample once, without any duplicates.\n  - In practice, we generate many (say 1,000) such random samples to approximate the sampling distribution.\n\n\nA sampling distribution for the mean BMI for $n=4$ can be constructed with the code below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# creates an empty vector to store results\nn4.bmi.bar <- numeric(1000) \n\n# a for loop that generates 1000 random samples \n# each size n=4, and calculates the sample mean.\nfor (i in 1:1000)\n{\n  n4.bmi.sample <- rnorm(4, 26, 4)  # randomly picks 4 values from N(26,4)\n  n4.bmi.bar[i] <- mean(n4.bmi.sample)  # calculate sample mean\n}\n\n# plot the sampling distribution as a histogram\nhist(n4.bmi.bar, xlim = c(14, 38), \n     xlab = \"Mean BMI of Sample\",\n     main = \"Sampling Distribution of Mean BMI for n=4\",\n     xaxt='n')\naxis(1, at=seq(14, 38, 4), pos=0)  # sets ticks on x-axis\nabline(v = 26, col = \"red\", lwd = 2, lty = 2)  # draws vertical line at mu\n```\n\n::: {.cell-output-display}\n![](10-Sampling-Dist-Mean_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## Question 5\n\n----\n\nIn the code cell below, enter commands to compute the center (as measured by the mean) and spread (as measured by the standard deviation)\nof the sampling distribution created in the previous code cell with samples each size $n=4$. After computing the statistics to summarize your sampling distribution, comment on how these values compare to the population parameters $\\mu=26$ and $\\sigma =4$.\n\n\n:::{.callout-note}\nSample means from the previous code cell are stored in the vector `n4.bmi.bar`.\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# enter a command to compute the mean of the sampling dist\n\n# enter a command to compute the st. dev. of the sampling dist\n```\n:::\n\n\n\n### Solution to Question 5\n\n----\n\nAfter completing and running the code cell above, comment on how the output compares to the mean and standard deviation of the population $X$.\n  \n\n\\\n\\\n\\\n\n\n# Shape of the Sampling Distribution\n\n----\n\nWe can use a <span style=\"color:dodgerblue\">**quantile-quantile plot**</span> (also called a <span style=\"color:dodgerblue\">**qq-plot**</span>) to compare the shape of our sampling distribution to the standard normal\ndistribution $N(0,1)$. A qq-plot is a great tool for determining how \"normal\" a distribution is, and we will shortly explore how to read qq-plots plots more carefully. For now we only consider the the following:\n\n-   The closer the points are to the line, the more normal the distribution.\n\nRun the code cell below to generate a qq-plot for the sampling distribution for the mean.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(n4.bmi.bar)\nqqline(n4.bmi.bar)\n```\n\n::: {.cell-output-display}\n![](10-Sampling-Dist-Mean_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n:::{.callout-note}\nThe plot above seems mostly normal in the middle, but the tails are slightly deviating from the tails of a normal distribution.\n:::\n\n\n## Question 6\n\n---\n\nOpen the app <https://adamspiegler.shinyapps.io/clt_bmi/> to experiment with changing the sample size $n$ used when constructing a sampling distribution for the mean BMI. In particular, explore the following properties of the sampling distribution for the mean BMI:\n\n- What is the shape of the sampling distribution?\n- What is the mean of the sampling distribution?\n- What is the standard deviation of the sampling distribution?\n- How does the population change when generating different sampling distributions?\n\nFill in values that describe these properties of the sampling distribution for $n=4$, $n=9$, $n=16$, and $n=81$.\n\n### Solution to Question 6\n\n----\n\n\\\n\n| Property | Population   | $n=4$ | $n=9$ | $n=16$ | $n=81$ |\n|-----|-----|-----|-----|-----|-----|\n| Shape | Normal |   |   |   |   |\n| Mean  | 26 |   |   |   |   |\n| Standard Deviation | 4 |   |   |   |   |\n\n\\\n\\\n\n\n# Sampling from a Skewed Distribution {#sec-train}\n\n---\n\nLet $Y$ denote all times (in minutes) that people wait before their train arrives at a certain train station. If we know the average wait time between arriving trains is $4$ minutes, then we can use an exponential distribution to model the distribution of wait times between arriving trains. The <span style=\"color:dodgerblue\">**rate parameter**</span> is $\\color{dodgerblue}{\\lambda = \\frac{1}{4}}$. The distribution of wait times between successive trains is therefore $\\color{dodgerblue}{Y \\sim \\mbox{Exp} \\left( \\frac{1}{4} \\right)}$.\n\nRun the code below to plot the probability density function for the train wait times, $Y \\sim \\mbox{Exp} \\left( \\frac{1}{4} \\right)$. There is nothing to edit in the code cell below, but be sure to compare the resulting plot with your answer in [Question 1].\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwait <- seq(0, 10, length=100)  # wait times from 0 to 10 min plotted\npdf.wait <- dexp(wait, 1/4)  # height of pdf function\n\nplot(wait,  # wait times plotted on x-axis\n     pdf.wait,  # corresponding pdf heights plotted on y-axis\n     type=\"l\",  # plot type \"l\" will connect points with a line \n     lty=1,  # lty=1 plots solid line\n     xlab=\"Wait Time (in minutes)\",  # label on x-axis\n     ylab=\"Density\",  # label on y-axis\n     main=\"Distribution of Population\")  # main label\n```\n\n::: {.cell-output-display}\n![](10-Sampling-Dist-Mean_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n:::{.callout-tip}\nRecall that an exponential distribution $Y$ with rate parameter $\\lambda = \\frac{1}{4}$ has:\n\n- Mean $\\mu_Y = \\frac{1}{\\lambda} = 4$ minutes. \n- Variance $\\sigma_Y^2 = \\frac{1}{\\lambda} = 4$.\n- Standard deviation $\\sigma_Y = \\sqrt{4}=2$ minutes.\n:::\n\n## Question 7\n\n----\n\nOpen the app <https://adamspiegler.shinyapps.io/clt_wait/> to experiment with changing the sample size $n$ used when constructing a sampling distribution of the sample mean wait time $\\overline{Y}$ between successive trains at a train station if we assume the time between successive trains is $Y \\sim \\mbox{Exp} \\left( \\frac{1}{4} \\right)$. After experimenting with the app, complete the table below to summarize your observations when sample sizes $n=4$, $n=9$, $n=16$, and $n=81$ are used to construct a sampling distribution.\n\n\n\n### Solution to Question 7\n\n----\n\n\\\n\n| Property | Population   | $n=4$ | $n=9$ | $n=16$ | $n=81$ |\n|-----|-----|-----|-----|-----|-----|\n| Shape | Skewed Right |   |   |   |   |\n| Mean  | 4 |   |   |   |   |\n| Standard Deviation | 2 |   |   |   |   |\n\n\\\n\\\n\n\n# Working with Empirical Data: Earthquake Depth\n\n----\n\nThe help documentation for the data set `quakes` in the `dplyr` package provides the following summary:\n\n> \"The data set give the locations of 1000 seismic events of MB $>$ 4.0.  The events occurred in a cube near Fiji since 1964.\"\n\nThe data set contains the five variables listed below.\n\n-   `lat`: Latitude of event\n-   `long`: Longitude\n-   `depth`: Depth (km)\n-   `mag`: Richter Magnitude\n-   `stations`: Number of stations reporting\n\nRun the code cell below to load the `dplyr` data set so we can access the `quakes` data set.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n:::\n\n\n\n## Numerical Summary of Quakes Data\n\n----\n\nThe first command will run and print the output of the `summary()` function that gives numerical summaries for all variables in the data set `quakes`.  In the second and third lines of code, we use `mean()` and `sd()` functions to compute the mean and standard deviation, respectively, of the all depth values stored in `quakes$depth`. Run the code cells below and note the population mean and standard deviation of the earthquake depths.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# requires dplyr package loaded above\nsummary(quakes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      lat              long           depth            mag      \n Min.   :-38.59   Min.   :165.7   Min.   : 40.0   Min.   :4.00  \n 1st Qu.:-23.47   1st Qu.:179.6   1st Qu.: 99.0   1st Qu.:4.30  \n Median :-20.30   Median :181.4   Median :247.0   Median :4.60  \n Mean   :-20.64   Mean   :179.5   Mean   :311.4   Mean   :4.62  \n 3rd Qu.:-17.64   3rd Qu.:183.2   3rd Qu.:543.0   3rd Qu.:4.90  \n Max.   :-10.72   Max.   :188.1   Max.   :680.0   Max.   :6.40  \n    stations     \n Min.   : 10.00  \n 1st Qu.: 18.00  \n Median : 27.00  \n Mean   : 33.42  \n 3rd Qu.: 42.00  \n Max.   :132.00  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(quakes$depth)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 311.371\n```\n:::\n\n```{.r .cell-code}\nsd(quakes$depth)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 215.5355\n```\n:::\n:::\n\n\n## Graphical Summary of Depth of Quakes\n\n----\n\nBefore we construct a sampling distribution for the mean depth of the earthquake data in `quakes`, run the `plot()` function in the code cell below to create a density plot of the depths and get a sense of the population we will be sampling from.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(density(quakes$depth),  # plot density of quake depth\n         xlab = \"Depth (in km)\",  # x-axis label\n         main = \"Depths of All Earthquakes in Fiji Since 1964\",  # main label\n         xaxt='n')  # exclude default x-axis\n\n# set custom ticks on x-axis\naxis(1, at=seq(-100, 800, 100), pos=0)  \n# draw vertical line at population mean\nabline(v = mean(quakes$depth), col = \"red\", lwd = 2, lty = 2)  \n```\n\n::: {.cell-output-display}\n![](10-Sampling-Dist-Mean_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n## Question 8\n\n----\n\nOpen the app <https://adamspiegler.shinyapps.io/clt_quake/> to experiment with changing the sample size $n$ used when constructing a sampling distribution of the sample mean earthquake depth $\\overline{Z}$ using the observed data in `quakes$depth`.  After experimenting with the app, complete the table below to summarize your observations when sample sizes $n=4$, $n=9$, $n=16$, and $n=81$ are used to construct a sampling distribution.\n\n\n### Solution to Question 8\n\n----\n\n\\\n\n| Property | Population   | $n=4$ | $n=9$ | $n=16$ | $n=81$ |\n|-----|-----|-----|-----|-----|-----|\n| Shape | Bimodal and Symmetric |   |   |   |   |\n| Mean  | 311.37 |   |   |   |   |\n| Standard Deviation | 215.54 |   |   |   |   |\n\n\\\n\\\n\n# Notation for Population, Sample, and Sampling Distribution\n\n----\n\nBefore collecting our thoughts, it will be helpful to introduce new notation to help us communicate and share observations. For each of the three contexts (BMI, train wait times, earthquake depths), we have been considering three different distributions:\n\n1. The distribution of values of the entire <span style=\"color:dodgerblue\">**population**</span>.\n2. The distribution of values in <span style=\"color:tomato\">**one random sample**</span> size $n$.\n3. The distribution of <span style=\"color:mediumseagreen\">**sample means for all random samples of size $n$**</span>.\n\nWe can avoid some confusion by carefully using different notation when expressing the mean and standard deviation depending on whether we are summarizing a population, a sample, or a sampling distribution. When describing the **mean** of a distribution we use the notation:\n\n-   <span style=\"color:dodgerblue\">Population mean: $\\mu_X$</span>\n-   <span style=\"color:tomato\">Sample mean: $\\bar{x}$</span>\n-   <span style=\"color:mediumseagreen\">Mean of the sampling distribution for a mean: $\\mu_{\\overline{X}}$</span>\n\nWhen describing the **standard deviation** of a distribution we use the\nnotation:\n\n-   <span style=\"color:dodgerblue\">Population standard deviation: $\\sigma_X$</span>\n\n-   <span style=\"color:tomato\">Sample standard deviation: $s_X$</span>\n\n-   <span style=\"color:mediumseagreen\">Spread of the sampling distribution is called the **Standard Error**</span>.\n  -   The standard error measures the variability in sample statistics due to randomness.\n  -   We use the notation $\\color{mediumseagreen}{\\mbox{SE}(\\overline{X}) = \\sigma_{\\overline{X}}}$.\n\n\n# Organizing Observations about Sampling Distributions\n\n----\n\n\n## Question 9\n\n----\n\nFor each of the three sampling distributions we examined in [Question 6], [Question 7], and [Question 8], summarize how the <span style=\"color:dodgerblue\">**shape**</span> of the sampling distribution of the sample means changed as the size of the samples, $n$, increased.\n\n\n### Solution to Question 9\n\n----\n\n\\\n\\\n\\\n  \n  \n## Question 10\n\n----\n\n\nFor each of the three sampling distributions we examined in [Question 6], [Question 7], and [Question 8], summarize how the <span style=\"color:dodgerblue\">**mean**</span> (center) of the sampling distribution changed as the size of the samples, $n$, increased.\n\n\n### Solution to Question 10\n\n----\n\n\\\n\\\n\\\n\n\n\n## Question 11\n\n----\n\nFor each of the three sampling distributions we examined in [Question 6], [Question 7], and [Question 8], summarize how the <span style=\"color:dodgerblue\">**standard error**</span> of the sampling distribution changed as the size of the samples, $n$, increased.\n\n\n### Solution to Question 11\n\n----\n\n\\\n\\\n\\\n  \n\n\n\n# Formal Statement of the Central Limit Theorem (for Sample Means) {#sec-cltmeans}\n\n----\n\nLet $X_1, X_2, \\ldots , X_n$ be independent, identically distributed\n(iid) random variables from a population with mean $\\mu_X$ and standard\ndeviation $\\sigma_X$, then as long as $n$ is large enough\n(informally $\\mathbf{n \\geq 30}$), the sampling distribution for the\nmean $\\overline{X} = \\frac{x_1 + x_2 + \\ldots + x_n}{n}$ will:\n\n-   Be (approximately) <span style=\"color:dodgerblue\">**normally distributed**</span>.\n-   Have mean equal to the mean of the population, $\\color{dodgerblue}{\\mu_{\\overline{X}}=\\mu_X}$.  \n-   Have standard error $\\color{dodgerblue}{\\mbox{SE}(\\overline{X}) = \\sigma_{\\overline{X}} = \\frac{\\sigma_X}{\\sqrt{n}}}$.\n\nThe three statements above become more accurate as $n$ gets larger. We summarize the results more concisely below.\n\n$${\\large \\color{dodgerblue}{\\overline{X} \\sim N \\left( \\mu_{\\overline{X}} , \\sigma_{\\overline{X}} \\right) = N \\left( \\mu_X  , \\frac{\\sigma_X}{\\sqrt{n}} \\right)}}$$\n\n## Question 12\n\n----\n\nUsing [properties of the expected value of linear combinations of random variables](06-Expected-Value-and-Variance.qmd#sec-prop-exp) prove the following:\n\n$$\\mu_{\\overline{X}} = E \\left( \\overline{X} \\right) = E \\left( \\frac{X_1 + X_2 + \\ldots + X_n}{n} \\right) = \\mu_X.$$\n\n\n### Solution to Question 12\n\n----\n\n\\\n\\\n\\\n\n\n\n\n## Question 13\n\n----\n\nUsing [properties of the variance of linear combinations of independent random variables](06-Expected-Value-and-Variance.qmd#sec-prop-var) prove the following:\n\n\n$$ \\sigma^2_{\\overline{X}} = \\mbox{Var} \\left( \\overline{X} \\right) = \\mbox{Var} \\left( \\frac{X_1 + X_2 + \\ldots + X_n}{n} \\right) = \\frac{\\sigma^2_X}{n}.$$\n\n### Solution to Question 13\n\n---\n\n\\\n\\\n\\\n\n\n---\n\n![Creative Commons License](https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png) <nbsp>\n\n*Statistical Methods: Exploring the Uncertain* by [Adam Spiegler](https://github.com/CU-Denver-MathStats-OER/Statistical-Theory) is licensed under a [Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License](http://creativecommons.org/licenses/by-nc-sa/4.0/).",
    "supporting": [
      "10-Sampling-Dist-Mean_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}