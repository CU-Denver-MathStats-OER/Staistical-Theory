---
output:
  html_document: default
---
# Bootstrap Distributions Part 1
### March 17, 2021

**Load required packages first**
```{r, message=FALSE}
library(resampledata)
```

## Question 13 Wetsuit Case Study

Recall the wetsuit example where we compared the maximum velocity of 12 swimmers each with a wetsuit and with a normal bathing suit. If instead of hypothesis test, suppose we have no claim and want to estimate what is the average difference between maximum velocities of all swimmers with and without the wetsuit. 

```{r}
# Vectors containing the times of each swimmer. Ordering is critical
wetsuit <- c(1.57, 1.47, 1.42, 1.35, 1.22, 1.75, 1.64, 1.57, 1.56, 1.53, 1.49, 1.51)
none <- c(1.49, 1.37, 1.35, 1.27, 1.12, 1.64, 1.59, 1.52, 1.50, 1.45, 1.44, 1.41)
Diff <- wetsuit - none
observed <- mean(Diff)
```

The mean of the differences of the sample is $\bar{x}_{\rm{diff}}=$ `r print(observed)` meters per second.

**Write out two different possible bootstrap samples that could be generated using the bootstrapping process for matched-pairs.**


**Construct a 95% bootstrap percentile confidence interval to estimate this difference and interpret your answer.**

```{r}
n <- length(Diff) # number of matched-pairs in sample

N <- 10^5
boot.diff <- numeric(N)

# Create bootstrap samples by picking n difference from original sample
# With replacement, and then find mean of those differences.
for (i in 1:N)
{
  result <- sample(???, ???, replace = ???)
  boot.diff[i] <- ???
}

# Calculate lower and upper cutoffs
# for the 95% Bootstrap CI
lower <- quantile(???, probs = ???)
upper <- quantile(???, probs = ???)
lower
upper

# Display results of bootstrap distribution
hist(boot.diff, xlab = "Difference", 
     main = "Bootstrap Distribution")
abline(v = observed, col = "red", lwd = 2, lty = 2)
abline(v = lower, col = "blue", lwd = 2, lty = 2)
abline(v = upper, col = "blue", lwd = 2, lty = 2)

mean.boot <- mean(boot.diff)
se.boot <- sd(boot.diff)
```


## Question 1 Verizon Repair Time Case Study

Verizon is the incumbent local exchange carrier (ILEC) for a large part of the Eastern US. When there is an emergency Verizon is responsible for making repairs for the customers of other telephone companies in the region known as competing local exchange carriers (CLEC's). Verizon is subject to fines if the repair times for CLEC customers are substantially worse than the times for Verizon customers. The dataset **Verizon** contains a sample of repair times (*Time*) for 1664 ILEC and 23 CLEC customers (*Group*). 

Rather than estimate the difference in mean times, suppose we look at the ratio of the means, what is the ratio of the ILEC mean repair time over the CLEC mean repair time?  **Construct a 95% bootstrap confidence interval for the ratio of the two means.**

```{r}
Time.ILEC <- subset(Verizon, select = ???, Group == ???, drop =T)
Time.CLEC <- subset(Verizon, select = ???, Group == ???, drop =T)

N <- 10^4
time.ratio.mean <- numeric(N)
for (i in 1:N)
{
  ILEC.sample <- sample(Time.ILEC, ???, replace = ???)
  CLEC.sample <- sample(Time.CLEC, ???, replace = ???)
  time.ratio.mean[i] <- ???
}

quantile(???, c(???, ???))
```

Comparing the observed ratio to the mean of the sampling distribution for the ratio of mean repair times.

```{r}
original.ratio <- mean(Time.ILEC)/mean(Time.CLEC)
mean2.boot <- mean(time.ratio.mean)

hist(time.ratio.mean, main = "Bootstrap dist for ratio of means")
abline(v = mean2.boot, col = "red", lty = 2, lwd = 1.5)
abline(v = original.ratio, col = "blue", lty = 2, lwd = 1.5)
```

Is the shape of the sampling distribution for the ratio of means normal?
