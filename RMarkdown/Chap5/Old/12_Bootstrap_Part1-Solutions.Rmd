---
output:
  html_document: default
---
# Bootstrap Distributions Part 1
### March 15, 2021

**Load required packages first**
```{r, message=FALSE}
library(resampledata)
```

## Question 1 NC Birth Weights Case Study

The dataset **NCBirths2004** from the textbook contains data from a random sample of 1009 babies born in North Carolina in 2004 and contains variables *Age* (mother's age), *Tobacco* (mother used tobacco?), *Gender* (gender assigned at birth to baby), *Weight*, *Gestation* (gestation period in weeks when born).

**Give a good estimate for the mean weight (in grams) of all babies born in North Carolina in 2004? How sure are you with your estimate?** 

## Setting up Bootstrap Distribution for Birth Weights

```{r}
N <- 10^5 # number of bootstrap resamples
result <-numeric(N) #vector where to store sample stats
weight <- NCBirths2004$Weight #vector of sample data
total <- length(weight) #How many observations in sample

# for each bootstrap resample, pick 1009 random numbers
# between 1 and 1009 (with replacement)
# Then pick corresponding values in original sample 
# and compute sample mean
for (i in 1:N)
{
  x <- sample(weight, total, replace = TRUE)
  result[i] <- mean(x)
}

# Create a histogram of resulting bootstrap sample means
hist(result,  xlab = "xbar",
     main = "Bootstrap Distribution")

mean(result) #Calculate center of bootstrap dist
sd(result) #Calculate bootstrap standard error
```

*****

## Questions 6-8: Bangladesh Arsenic Case Study

Arsenic is a naturally occurring element in the groundwater in Bangladesh. Much of this water is used for drinking in rural areas,
so arsenic poisoning is a serious health issue. The dataset **Bangladesh** contains measurements on arsenic, chlorine, and cobalt levels (in parts per billion, ppb) present in each of 271 groundwater samples. 

### Question 6

**Using R, calculate the mean and standard deviation of the arsenic level of the sample.**

```{r}
# Load and summarize the sample
Arsenic <- Bangladesh$Arsenic
sample.mean <- mean(Arsenic)
sample.sd <- sd(Arsenic)
```

### Question 7

**Using R, construct a histogram to see the distribution of sample values. Does the sample appear to be normal?**

``` {r}
hist(Arsenic)
qqnorm(Arsenic)
qqline(Arsenic)
```

### Question 8

**How can we account for the uncertainty of the estimate due to the randomness in sampling? In other words, how much margin of error is reasonable to expect in this estimate? How can we measure that uncertainty?**

```{r}
n <- length(Arsenic) # how many observations in Arsenic
N <- 10^4 # Number of bootstrap samples
boot.mean <- numeric(N) #create vector to store bootstrap means

for (i in 1:N)
{
  x <- sample(Arsenic, n, replace = TRUE)
  boot.mean[i] <- mean(x)
}

# Show bootstrap distribution
hist(boot.mean, xlab = "xbar", 
     main = "Bootstrap Distribution")

# Add a vertical line at actual observed sample mean
abline(v = sample.mean, col = "red", lwd = 2, lty = 2)

# Compare bootstrap dist to normal dist
qqnorm(boot.mean)
qqline(boot.mean)
```

## Question 10: Interval Estimate for Mean Arsenic Level

For a normal distribution, we know that **95% of all values are within approximately 2 standard deviations from the mean**. Using this rough estimate and previous results for the standard error, **give a possible interval that contains approximately 95% of all bootstrap samples in the Bangladesh Arsenic level case study.**

```{r}
sample.mean - 2*sd(boot.mean) #going 2 SE's below the point est
sample.mean + 2*sd(boot.mean) #going 2 SE's below the point est
```

**Using the quantile function in R** give another possible interval that contains approximately 95% of all bootstrap samples in the Bangladesh Arsenic level case study.

```{r}
quantile(boot.mean, c(0.025, 0.975))
```

## Question 11

**Using the quantile function in R, compute a 95% bootstrap confidence interval to estimate the mean weight of all babies born in North Carolina in 2004.**

```{r}
quantile(result, c(0.025, 0.975)) #recall these were stored in result
```

**Interpret the practical meaning of your answer.**

There is a 95% chance the interval from `r quantile(result, 0.025)` grams to `r quantile(result, 0.975)` grams contains the actual mean value for all births in North Carolina in 2004.

## Question 12: Cable Repair Times Case Study

What is the difference between the length of commercials on basic cable channels and on extended cable channels? The table shows the total number of minutes devoted to commercials during randomly selected half-hour periods on basic and extended cable TV channels.

Basic    | 7   | 10  | 10.6 | 10.2 | 8.6 | 7.6 | 8.2 | 10.4 | 11.0 | 8.5 |     |  
---------|-----|-----|------|------|-----|-----|-----|------|------|-----|-----|-----
Extended | 3.4 | 7.8 | 9.4  | 4.7  | 5.4 | 7.6 | 5.0 | 8.0  | 7.8  | 9.6 | 6.2 | 8.1

**How can we use exploratory data analysis to compare the two groups?**

```{r}
times.Basic <- c(7, 10, 10.6, 10.2, 8.6, 7.6, 8.2, 10.4, 11.0, 8.5)
times.Ext <- c(3.4, 7.8, 9.4, 4.7, 5.4, 7.6, 5.0, 8.0, 7.8, 9.6, 6.2, 8.1)

# hist(times.Basic)
# hist(times.Ext)
boxplot(times.Basic, times.Ext, 
        names = c("Basic", "Extended"))

# Comparing descriptive statistics
n.Basic <- length(times.Basic)
mean(times.Basic)
sd(times.Basic)

n.Ext <- length(times.Ext)
mean(times.Ext)
sd(times.Ext)

observed <- mean(times.Basic) - mean(times.Ext)
observed
```

**Give a  90% bootstrap percentile confidence interval to estimate the difference between the length of commercial times.**

```{r}
# Create numeric vector to store bootstrap samples
N <- 10^4
times.diff.mean <- numeric(N)

for (i in 1:N)
{
  Basic.boot <- sample(times.Basic,  
                       n.Basic, replace=TRUE)
  Ext.boot <- sample(times.Ext, 
                     n.Ext, replace=TRUE)
  times.diff.mean[i] <-  
    mean(Basic.boot)-mean(Ext.boot)
}

# Bootstrap mean and bootstrap standard error
mean(times.diff.mean)
sd(times.diff.mean)

# Find cutoffs for 90% bootstrap CI
lower <- quantile(times.diff.mean, probs = 0.05)
upper <- quantile(times.diff.mean, probs = 0.95)

# Display bootstrap distribution
hist(times.diff.mean)
abline(v = observed, col = "red", lwd = 2, lty = 2)
abline(v = lower, col = "blue", lwd = 2, lty = 2)
abline(v = upper, col = "blue", lwd = 2, lty = 2)
```

**Interpret the practical meaning of your answer.**

There is a 90% chance the interval from `r lower` minutes to `r upper` minutes contains the actual difference in the mean time of all commercials on basic and extended cable channels.