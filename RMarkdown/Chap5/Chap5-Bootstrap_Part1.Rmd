---
output:
  pdf_document: default
---
# Bootstrap Distributions Part 1

**Load required packages first**
```{r, message=FALSE}
library(resampledata)
```

## Intro Exercise

### Picking one random sample

```{r}
my.samp <- sample(NCBirths2004$Weight, 10, replace = FALSE)
print(my.samp)
mean(my.samp)
```

### Bootstrapping from my.samp

```{r}
N <- 10^5 # Number of bootstrap samples
boot.dist <- numeric(N) #create vector to store bootstrap means

for (i in 1:N)
{
  x <- sample(my.samp, 10, replace = TRUE) #bootstrap
  boot.dist[i] <- mean(x)  #mean of bootstrap
}

mean(boot.dist) #Calculate center of bootstrap dist
sd(boot.dist) #Calculate bootstrap standard error

# Show bootstrap distribution
hist(boot.dist,  xlab = "xbar",
     main = "Bootstrap Distribution")

# Add a red line at the observed sample mean
abline(v = mean(my.samp), col = "red", lwd = 2, lty = 1)

# Add a blue line at the center of bootstrap dist s
abline(v = mean(boot.dist), col = "blue", lwd = 2, lty = 2)

# Add a green line at the center of bootstrap dist s
abline(v = mean(NCBirths2004$Weight), col = "green", lwd = 2, lty = 2)
```

### Comparing with population and attaching uncertainty to estimate.

```{r}
mean(boot.dist) - mean(my.samp)
mean(NCBirths2004$Weight)
sd(NCBirths2004$Weight)/sqrt(10)
mean(my.samp) + 2*sd(NCBirths2004$Weight)/sqrt(10)
mean(my.samp) - 2*sd(NCBirths2004$Weight)/sqrt(10)
```

## Bangladesh Arsenic Case Study

Arsenic is a naturally occurring element in the groundwater in Bangladesh. Much of this water is used for drinking in rural areas,
so arsenic poisoning is a serious health issue. The dataset **Bangladesh** contains measurements on arsenic, chlorine, and cobalt levels (in parts per billion, ppb) present in each of 271 groundwater samples. 


a. Calculate the mean and standard deviation and size of the arsenic level of the sample.

```{r}
# Load and summarize the sample
arsenic <- Bangladesh$Arsenic
samp.mean <- ???
samp.sd <- ???
n.arsenic <- length(arsenic) # how many observations in arsenic
```

b. Create a histogram to show the shape of the distribution of the sample data. How would you describe the shape?

```{r}
hist(???)
# Optional code below creates a cool thing we have yet to encounter.
# We'll see how to interpret this plot shortly.
qqnorm(arsenic)
qqline(arsenic)
```

c. What are the center and spread (standard error) of the bootstrap resample?

```{r}
N <- 10^5 # Number of bootstrap samples
boot.dist <- numeric(N) #create vector to store bootstrap means

# Set up a for loop!

for (i in 1:N)
{
  x <- sample(???, ???, replace = TRUE)
  boot.dist[i] <- ????
}

mean(???) #Calculate center of bootstrap dist
sd(???) #Calculate bootstrap standard error

# Show bootstrap distribution
hist(boot.dist,  xlab = "xbar",
     main = "Bootstrap Distribution")

# Add a red line at the observed sample mean
abline(v = ???, col = "red", lwd = 2, lty = 2)

# Add a blue line at the center of bootstrap dist s
abline(v = ???, col = "blue", lwd = 2, lty = 2)

# Compare bootstrap dist to normal dist
# Again, we'll get to these.
qqnorm(boot.dist)
qqline(boot.dist)
```

## Interval Estimates for Mean Arsenic Level

a. Compute a 95% bootstrap percentile confidence interval for the mean arsenic level in groundwater in Bangladesh.

```{r}
# Find cutoffs for 95% bootstrap CI
lower <- quantile(???, probs = ???)
upper <- quantile(???, probs = ???)
lower
upper
```

b. Interpret the practical meaning of the interval estimate.

```{r}
hist(boot.dist,  xlab = "xbar",
     main = "Bootstrap Distribution")

# Add a red line at the observed sample mean
abline(v = ???, col = "red", lwd = 2, lty = 2)

# Add blue lines at the 2.5 and 97.5 percentiles
abline(v = lower, col = "blue", lwd = 2, lty = 2)
abline(v = upper, col = "blue", lwd = 2, lty = 2)
```

This interval is giving a range of plausible values for the mean arsenic level of all groundwater in Bangladesh. We are 95% confident that the mean arsenic level is between ??? ppb and ??? ppb.


c. Sometimes it is nice to describe the interval as some value plus or minus some margin of error. Recall with normal distributions, approximately 95% of the data is within 2 standard deviations of center of the distribution.  Construct a symmetric 95% bootstrap confidence interval for the mean arsenic level.

```{r}
samp.mean - 2*??? #going 2 SE's below the point est
samp.mean + 2*??? #going 2 SE's below the point est
```

## North Carolina Birth Weights Revisited

a. Give a 95% bootstrap percentile confidence interval for the mean weight of babies born in North Carolina in 2004. 

```{r}
mean.weight <- ???(NCBirths2004$Weight)
sd.weight <- ???(NCBirths2004$Weight)
n.weight <- ???(NCBirths2004$Weight)

N <- 10^5 # Number of bootstrap samples
boot.weight <- numeric(N) #create vector to store bootstrap means

for (i in 1:N)
{
  y <- sample(???, ???, replace = TRUE)
  boot.weight[i] <- ????
}

# Find cutoffs for 95% bootstrap CI
lower <- quantile(???, probs = ???)
upper <- quantile(???, probs = ???)
lower
upper

hist(boot.weight,  xlab = "xbar",
     main = "Bootstrap Distribution")

# Add a red line at the observed sample mean
abline(v = ???, col = "red", lwd = 2, lty = 2)

# Add blue lines at the 2.5 and 97.5 percentiles
abline(v = lower, col = "blue", lwd = 2, lty = 2)
abline(v = upper, col = "blue", lwd = 2, lty = 2)
```


b. Give a 90% bootstrap confidence interval to estimate the mean weight of all babies born in North Carolina in 2004.

```{r}
# Find cutoffs for 90% bootstrap CI
lower.cl90 <- quantile(???, probs = ???)
upper.cl90 <- quantile(???, probs = ???)
lower.cl90
upper.cl90
```

c. Interpret the practical meaning of your 90% bootstrap percentile confidence interval.

d. When we decreased the confidence level, what happened to the confidence interval estimate?

