---
output:
  html_document: default
---
# Confidence Interval for Means and Proportions
### April 12, 2021

**Load required packages first**
```{r, message=FALSE}
library(resampledata)
```

## Question 6 Worksheet 14

Using the dataset *NCBirths2004*, give a 99% confidence interval for the mean weight (in grams) of all babies born in North Carolina in 2004.

(a) What is the point estimate?

```{r}
sample <- NCBirths2004$Weight
xbar <- mean(sample)
n <- length(sample)
n
xbar
```

(b) What value of $t{\alpha/2}$ should you use?

Use t-distribution since the population variance is unknown. Our sample has size 1009 observations, so our t-distribution will have **df = 1009-1 = 1008**.

```{r}
t.star <- qt(0.995, n-1)
t.star
```
(c) Give an approximation for the standard error of the sampling distribution for the sample mean.

```{r}
se <- sd(sample)/sqrt(n)
se
```

(d) What is the margin of error of your 99% confidence interval?

```{r}
me <- t.star * se
me
```

(e) Give a 99% confidence interval based on your answers above.

```{r}
lower <- xbar - me
upper <- xbar + me
upper
lower
```

(f) Construct a 99% confidence interval using the t.test command in R.

```{r}
t.test(sample, conf.level = 0.99)$conf
```

(g) Interpret the meaning of your answer in practical terms. 

There is a 99% chance the interval `r lower` grams to `r upper` grams contains the actual mean weight of all newborns in North Carolina in 2004.


## Question 8 Worksheet 14 

A study randomly assigned students to take notes either writing them by hand or using a laptop. The resulting scores of the students on a test of the material are summarized in the table below:

Group | n | $\bar{x}$ | s 
----- | - | --------- | --
By hand | 38 | 25.6 | 10.8
Laptop | 40 | 18.3 | 9.0

(a) Give a 95% confidence interval using an approximation with a $t$-distribution with degrees of freedom equal to the $n_{\rm min} -1$.

```{r}
diff.means <- 25.6 - 18.3
se <- sqrt(10.8^2/38 + 9^2/40)
t.star <- qt(0.975, 38-1)
me <- t.star*se
upper <- diff.means + me
lower <- diff.means - me
upper
lower
```

(b) Interpret the meaning of your answer. Do you believe there is a difference in the exam scores of the two groups? Explain. 

There is a 95% chance the interval from `r lower` to `r upper` contains the difference in mean exam scores between the two groups of students.

Yes, there is a difference since 0 is not inside the confidence interval.

(c) If you use Welch's approximation, you get $v = 72.1368 \approx 72$. Give a 95% confidence interval using an approximation with a $t$-distribution with degrees of freedom equal to the v=72.

```{r}
t.star2 <- qt(0.975, 72)
me2 <- t.star2*se
upper2 <- diff.means + me2
lower2 <- diff.means - me2
upper2
lower2
```

## Question 2 Worksheet 15

A random sample of 1,082 registered voters in the US, 29% of the people polled said they do not intend to get vaccinated for COVID-19. Construct a 95% confidence interval to estimate the proportion of all adults in the US that do not plan to get vaccinated for COVID-19.

```{r}
phat <- 0.29
n <- 1082
se <- sqrt(phat*(1-phat)/n)
z.star <- qnorm(0.975, 0 ,1)
me <- se*z.star
upper <- phat + me
lower <- phat - me
upper
lower
```

## Question 3 Worksheet 15

Find 95% confidence interval for the proportion of all adults in the US that do not plan to get vaccinated using the **Agresti-Coull** Confidence Interval for a Proportion.

The original sample had n=1082 and X = 314 giving p-hat = 0.29

```{r}
ptilde <- (314+2)/(1082+4)
ntilde <- 1082+4
se.tilde <- sqrt(ptilde*(1-ptilde)/ntilde)
z.star <- qnorm(0.975, 0 ,1)
me.tilde <- se.tilde*z.star
upper.ac <- ptilde + me.tilde
lower.ac <- ptilde - me.tilde
upper.ac
lower.ac
```

## Question 5 Worksheet 15

Find 95% confidence interval for the proportion of all adults in the US that do not plan to get vaccinated using the score confidence interval for a proportion.


```{r}
lower <- (phat+z.star^2/(2*n) - 
            z.star*sqrt( (phat*(1-phat))/n + z.star^2/(4*n^2) ) )/(1+z.star^2/n)
upper <- (phat+z.star^2/(2*n) + 
            z.star*sqrt( (phat*(1-phat))/n + z.star^2/(4*n^2) ) )/(1+z.star^2/n)
lower
upper
```

Find 95% confidence interval for the proportion of all adults in the US that do not plan to get vaccinated using the score confidence interval for a proportion using the prop.test command.

```{r}
prop.test(314, 1082, conf.level = 0.95)$conf
```

## Question 6 Worksheet 15

Using the data below collected from a survey, construct a 90\% interval for the difference in the proportion of all Democrats and proportion of all Republicans that do not plan to be vaccinated.

Party | Yes, will | Yes, already | No | Unsure | Total
----- | --------- | ------------ | -- | ------ | -----
Democrat | 213 | 108 | 40 | 7 | 368
Republican | 93 | 70 | 120 | 9 | 292
Total | 306 | 178 | 160 | 16 | 660

```{r}
dem.prop <- 40/368
rep.prop <- 120/292
z.star <- qnorm(0.95, 0, 1) # for a 90% conf level
se <- sqrt(dem.prop*(1-dem.prop)/368 + rep.prop*(1-rep.prop)/292)
lower <- dem.prop-rep.prop - z.star*se
upper <- dem.prop-rep.prop + z.star*se
lower
upper
```

There's a 90% chance the interval from `r lower` to `r upper` contains the actual difference in the proportion of all Democrats and all Republicans that do not plan to get vaccinated for COVID-19.

Since the interval contains only negative values (and zero is not in the interval), we see that there is a difference in the proportion of Republicans and Democrats that are not planning to get vaccinated.

Or R has a built score confidence interval command:

```{r}
prop.test(c(40, 120), c(368, 292), conf.level=0.90)$conf
```
