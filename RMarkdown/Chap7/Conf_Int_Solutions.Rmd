---
output:
  html_document: default
---
# Confidence Interval for Means and Proportions

**Load required packages first**
```{r, message=FALSE}
library(resampledata)
```

## Question 6 Worksheet 16

Using the dataset *NCBirths2004*, give a 99% confidence interval for the mean weight (in grams) of all babies born in North Carolina in 2004.

(a) What is the point estimate?

```{r}
sample <- NCBirths2004$Weight
xbar <- mean(sample)
n <- length(sample)
```

(b) What value of $t_{\alpha/2}$ should you use?

```{r}
t.star <- qt(0.995, n-1)
```

(c) Give an approximation for the standard error of the sampling distribution for the sample mean.

```{r}
se <- sd(sample)/sqrt(n)
```

(d) What is the margin of error of your 99% confidence interval?

```{r}
me <- t.star * se
```

(e) Give a 99% confidence interval based on your answers above.

```{r}
lower <- xbar - me
upper <- xbar + me
lower
upper
```

A 99% confidence interval is `r lower` < $\mu$ < `r upper`.

(f) Construct a 99% confidence interval using the t.test command in R.

```{r}
t.test(sample, conf.level = 0.99)$conf
```

(g) Interpret the meaning of your answer in practical terms. 

There is a 99% chance that the interval from `r lower` grams to `r upper` grams contains the actual mean weight of all newborns in North Carolina in 2004.

## Question 8 Worksheet 16 

A study randomly assigned students to take notes either writing them by hand or using a laptop. The resulting scores of the students on a test of the material are summarized in the table below:

Group | n | $\bar{x}$ | s 
----- | - | --------- | --
By hand | 38 | 25.6 | 10.8
Laptop | 40 | 18.3 | 9.0

(a) Give a 95% confidence interval using an approximation with a $t$-distribution with degrees of freedom equal to the $n_{\rm min} -1$.

```{r}
diff.means <- 25.6 - 18.3
se <- sqrt(10.8^2/38 + 9^2/40)
t.star <- qt(0.975, 38-1)
me <- se*t.star
lower <- diff.means - me
upper <- diff.means + me
lower
upper
```

(b) Interpret the meaning of your answer. Do you believe there is a difference in the exam scores of the two groups? Explain. 

There is a 95% chance the interval from `r lower` to `r upper` contains the actual mean difference in exam scores between those that took notes by hand and those that took notes on a laptop. Since 0 is not in the confidence interval, we see that there is a difference in the exam scores.

(c) If you use Welch's approximation, you get $v = 72.1368 \approx 72$. Give a 95% confidence interval using an approximation with a $t$-distribution with degrees of freedom equal to the v=72.

```{r}
diff.means <- 25.6 - 18.3
se <- sqrt(10.8^2/38 + 9^2/40)
t.star <- qt(0.975, 72)
me <- se*t.star
lower <- diff.means - me
upper <- diff.means + me
lower
upper
```

## Question 2 Worksheet 17

A random sample of 1,082 registered voters in the US, 29% of the people polled said they do not intend to get vaccinated for COVID-19. Construct a 95% confidence interval to estimate the proportion of all adults in the US that do not plan to get vaccinated for COVID-19.

```{r}
phat <- 0.29
n <- 1082
se <- sqrt(phat*(1-phat)/n)
z.star <- qnorm(0.975, 0, 1)
me <- z.star * se
lower <- phat - me
upper <- phat + me
lower
upper
```

## Question 3 Worksheet 17

Find 95% confidence interval for the proportion of all adults in the US that do not plan to get vaccinated using the **Agresti-Coull** Confidence Interval for a Proportion.

```{r}
ptilde <- (314+2)/(1082+4)
ntilde <- 1082+4
ptilde
se.tilde <- sqrt(ptilde*(1-ptilde)/ntilde)
me.tilde <- se.tilde * z.star
lower.ac <- ptilde - me.tilde
upper.ac <- ptilde + me.tilde
lower.ac
upper.ac
```

## Question 5 Worksheet 17

Find 95% confidence interval for the proportion of all adults in the US that do not plan to get vaccinated using the score confidence interval for a proportion.

```{r}
phat2 <- 314/1082
lower.score <- (phat2+z.star^2/(2*n) - 
            z.star*sqrt( (phat2*(1-phat2))/n + z.star^2/(4*n^2) ) )/(1+z.star^2/n)
upper.score <- (phat2+z.star^2/(2*n) +
            z.star*sqrt( (phat2*(1-phat2))/n + z.star^2/(4*n^2) ) )/(1+z.star^2/n)
lower.score
upper.score
```

Find 95% confidence interval for the proportion of all adults in the US that do not plan to get vaccinated using the score confidence interval for a proportion using the prop.test command.

```{r}
prop.test(314, 1082, conf.level = 0.95)$conf
```

```{r}
phat2 <- 314/1082
lower.score2 <- (phat2+z.star^2/(2*n) - 
            z.star*sqrt( (phat2*(1-phat2))/n + z.star^2/(4*n^2) ) )/(1+z.star^2/n)
upper.score2 <- (phat2+z.star^2/(2*n) +
            z.star*sqrt( (phat2*(1-phat2))/n + z.star^2/(4*n^2) ) )/(1+z.star^2/n)
lower.score2
upper.score2
```

## Question 6 Worksheet 17

Using the data below collected from a survey, construct a 90\% interval for the difference in the proportion of all Democrats and proportion of all Republicans that do not plan to be vaccinated.

Party | Yes, will | Yes, already | No | Unsure | Total
----- | --------- | ------------ | -- | ------ | -----
Democrat | 213 | 108 | 40 | 7 | 368
Republican | 93 | 70 | 120 | 9 | 292
Total | 306 | 178 | 160 | 16 | 660

```{r}
prop.test(c(40, 120), c(368, 292), conf.level = 0.95)$conf
```

Since the confidence interval does not contain 0, it is no plausible to believe there is not a difference. Thus, based on this survey we see that the proportion of Democrats that will not get vaccinated is less than the proportion of Republicans that do not plan to get vaccinated.