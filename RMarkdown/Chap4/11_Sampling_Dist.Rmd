---
output:
  html_document: default
---

# Sampling Distributions

Of all students currently enrolled at CU Denver, 60% are undergraduate and 40% are graduate students.

Let <font color="green">$T=\hat{p}$ denote the proportion of students out of a random sample of 100 CU Denver students that are undergraduates</font>. If we pick many random samples each size n=100 CU Denver students, what is the value of the mean and SE for the sampling distribution for the values of $\hat{p}$? 

### Calculating the Expected Value

+ Let X denote the number of undergrads in a random sample of 100 students at CU Denver. 
  + We have $X \sim Binom(100,0.6)$.
  + Then $\hat{p} = \frac{X}{n}$.
$$
E(\hat{P}) = E \left( \frac{X}{n} \right) = \frac{1}{n} E(X) = \frac{1}{n}(np) = p
$$
  + We expect the sample proportion to equal the population proportion, <font color="green">$\mu_{\hat{p}} = p = 0.60$</font>

### Calculating the Standard Error

$$
\mbox{Var} (\hat{P}) = \mbox{Var} \left( \frac{X}{n} \right) = \frac{1}{n^2} \mbox{Var}(X) = \frac{1}{n^2}(npq) = \frac{p(1-p)}{n}
$$
Thus we have 
$$\mbox{SE} = \sqrt{\mbox{Var}(\hat{P})} = \sqrt{\frac{p(1-p)}{n}}$$

For the proportion of students that are undergrads, we therefore have <font color="green">$\mbox{SE}= \sqrt{\frac{(0.6)(0.4)}{100}} \approx 0.04899$</font>.

## We run a simulation when n=100 to compare with the theory:

```{r}
N <- 100 #Size of each sample
p <- 0.6 #Probability of a "success", student chosen is an undergraduate
B <- 10^5 #Pick 10,000 random samples each size N

results <- numeric(B) # create a numeric vector with B entries to store statistics

for (i in 1:B) 
{
  results[i] <- rbinom(1, N, p)/N
}

hist(results, xlab = "Prop of Undergrads", main="N=100", xlim=c(0.3,0.9))
abline(v = p, col = "red", lwd=2)
mean(results) # mean of sampling dist
sd(results) # SE of sampling dist
```

What happens to the mean and standard error if we increase the sample size from $n=100$ to $n=200$? To $n=500$?

# For n=200 we have
```{r}
N <- 200 #Size of each sample

results <- numeric(B) # create a numeric vector with B entries to store statistics

for (i in 1:B) 
{
  results[i] <- rbinom(1, N, p)/N
}

hist(results, xlab = "Prop of Undergrads", main="N=200", xlim=c(0.3,0.9))
abline(v = p, col = "red", lwd=2)
mean(results) # mean of sampling dist
sd(results) # SE of sampling dist
```

# For n=500 we have
```{r}
N <- 500 #Size of each sample

results <- numeric(B) # create a numeric vector with B entries to store statistics

for (i in 1:B) 
{
  results[i] <- rbinom(1, N, p)/N
}

hist(results, xlab = "Prop of Undergrads", main="N=500", xlim=c(0.3,0.9))
abline(v = p, col = "red", lwd=2)
mean(results) # mean of sampling dist
sd(results) # SE of sampling dist
```

# For n=1000 we have
```{r}
N <- 1000 #Size of each sample

results <- numeric(B) # create a numeric vector with B entries to store statistics

for (i in 1:B) 
{
  results[i] <- rbinom(1, N, p)/N
}

hist(results, xlab = "Prop of Undergrads", main="N=1000", xlim=c(0.3,0.9))
abline(v = p, col = "red", lwd=2)
mean(results) # mean of sampling dist
sd(results) # SE of sampling dist
```
